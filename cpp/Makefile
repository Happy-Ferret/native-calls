include $(NACL_SDK_ROOT)/tools/common.mk

CFLAGS = -Wall -Wno-strict-aliasing

all: install

# Build rules generated by macros from common.mk:
#

TARGET := NaClRPCInstance
SOURCES := NaClRPCInstance.cpp
$(foreach src,$(SOURCES),$(eval $(call COMPILE_RULE,$(src),$(CFLAGS))))
$(eval $(call LIB_RULE,$(TARGET),$(SOURCES)))

ifeq ($(TOOLCHAIN),glibc)
$(eval $(call SO_RULE,$(TARGET),$(SOURCES)))
endif

# RPCTransport
$(foreach src,RPCTransport.cpp,$(eval $(call COMPILE_RULE,$(src),$(CFLAGS))))
$(eval $(call LIB_RULE,RPCTransport,RPCTransport.cpp))

ifeq ($(TOOLCHAIN),glibc)
$(eval $(call SO_RULE,RPCTransport,RPCTransport.cpp))
endif

# JSONRPC
$(foreach src,JSONRPC.cpp,$(eval $(call COMPILE_RULE,$(src),$(CFLAGS))))
$(eval $(call LIB_RULE,JSONRPC,JSONRPC.cpp))

ifeq ($(TOOLCHAIN),glibc)
$(eval $(call SO_RULE,JSONRPC,JSONRPC.cpp))
endif
